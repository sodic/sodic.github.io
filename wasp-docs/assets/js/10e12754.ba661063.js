"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[9446],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>h});var o=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function r(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},s=Object.keys(e);for(o=0;o<s.length;o++)n=s[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)n=s[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=o.createContext({}),p=function(e){var t=o.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=p(e.components);return o.createElement(l.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},m=o.forwardRef((function(e,t){var n=e.components,a=e.mdxType,s=e.originalType,l=e.parentName,c=r(e,["components","mdxType","originalType","parentName"]),u=p(n),m=a,h=u["".concat(l,".").concat(m)]||u[m]||d[m]||s;return n?o.createElement(h,i(i({ref:t},c),{},{components:n})):o.createElement(h,i({ref:t},c))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var s=n.length,i=new Array(s);i[0]=m;var r={};for(var l in t)hasOwnProperty.call(t,l)&&(r[l]=t[l]);r.originalType=e,r[u]="string"==typeof e?e:a,i[1]=r;for(var p=2;p<s;p++)i[p]=n[p];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}m.displayName="MDXCreateElement"},38610:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(67294),a=n(44996);const s=e=>o.createElement("div",null,o.createElement("p",{align:"center"},o.createElement("figure",null,o.createElement("img",{style:{width:e.width},alt:e.alt,src:(0,a.Z)(e.source)}),o.createElement("figcaption",{class:"image-caption",style:{fontStyle:"italic",opacity:.6,fontSize:"0.9rem"}},e.caption))))},92908:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(67294),a=n(39960);n(44996);const s=()=>o.createElement("span",{className:"in-blog-cta--divider"}," \u2192 "),i=()=>o.createElement("p",{className:"in-blog-cta-link-container"},o.createElement(a.Z,{className:"in-blog-cta--link",to:"https://e44cy1h4s0q.typeform.com/to/ycUzQa5A"},"We are in Beta (try it out)!"),o.createElement(s,null),o.createElement(a.Z,{className:"in-blog-cta--link",to:"https://discord.gg/rzdnErX"},"Join our community"),o.createElement(s,null),o.createElement(a.Z,{className:"in-blog-cta--link",to:"https://wasp-lang.notion.site/Founding-Engineer-at-Wasp-402274568afa4d7eb7f428f8fa2c0816"},"Work with us"))},27002:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>r,default:()=>m,frontMatter:()=>i,metadata:()=>l,toc:()=>c});var o=n(87462),a=(n(67294),n(3905)),s=(n(39960),n(44996),n(92908),n(70589),n(38610));const i={title:"Build a real-time voting app with WebSockets, React & TypeScript \ud83d\udd0c\u26a1\ufe0f",authors:["vinny"],image:"/img/websockets-app/websockets-banner.png",tags:["wasp","websockets","react","typescript","real-time","node","express"]},r=void 0,l={permalink:"/blog/2023/08/09/build-real-time-voting-app-websockets-react-typescript",editUrl:"https://github.com/wasp-lang/wasp/edit/release/web/blog/2023-08-09-build-real-time-voting-app-websockets-react-typescript.md",source:"@site/blog/2023-08-09-build-real-time-voting-app-websockets-react-typescript.md",title:"Build a real-time voting app with WebSockets, React & TypeScript \ud83d\udd0c\u26a1\ufe0f",description:"TL;DR",date:"2023-08-09T00:00:00.000Z",formattedDate:"August 9, 2023",tags:[{label:"wasp",permalink:"/blog/tags/wasp"},{label:"websockets",permalink:"/blog/tags/websockets"},{label:"react",permalink:"/blog/tags/react"},{label:"typescript",permalink:"/blog/tags/typescript"},{label:"real-time",permalink:"/blog/tags/real-time"},{label:"node",permalink:"/blog/tags/node"},{label:"express",permalink:"/blog/tags/express"}],readingTime:21.78,hasTruncateMarker:!1,authors:[{name:"Vinny",title:"DevRel @ Wasp",url:"https://vincanger.github.io",email:"vince@wasp-lang.dev",imageURL:"https://vincanger.github.io/assets/vince_smiley.jpg",key:"vinny"}],frontMatter:{title:"Build a real-time voting app with WebSockets, React & TypeScript \ud83d\udd0c\u26a1\ufe0f",authors:["vinny"],image:"/img/websockets-app/websockets-banner.png",tags:["wasp","websockets","react","typescript","real-time","node","express"]},prevItem:{title:"Using Product Requirement Documents to Generate Better Web Apps with AI",permalink:"/blog/2023/08/23/using-product-requirement-documents-generate-better-web-apps-with-ai"},nextItem:{title:"Smol AI \ud83d\udc23 vs. Wasp AI \ud83d\udc1d - Which is the Better AI Junior Developer?",permalink:"/blog/2023/08/01/smol-ai-vs-wasp-ai"}},p={authorsImageUrls:[void 0]},c=[{value:"TL;DR",id:"tldr",level:2},{value:"Why WebSockets?",id:"why-websockets",level:2},{value:"How WebSockets Work",id:"how-websockets-work",level:2},{value:"Adding WebSockets Support in a React-NodeJS App",id:"adding-websockets-support-in-a-react-nodejs-app",level:2},{value:"What You Shouldn\u2019t Use: Serverless Architecture",id:"what-you-shouldnt-use-serverless-architecture",level:3},{value:"Using ExpressJS with Socket.IO  \u2014 Complex/Customizable Method",id:"using-expressjs-with-socketio---complexcustomizable-method",level:3},{value:"Implementing WebSockets with Wasp \u2014 Fast/Zero Config Method",id:"implementing-websockets-with-wasp--fastzero-config-method",level:3},{value:"Comparing the Two Approaches",id:"comparing-the-two-approaches",level:2},{value:"Implementing WebSockets Using React, Express.js (Without Wasp)",id:"implementing-websockets-using-react-expressjs-without-wasp",level:3},{value:"Implementing WebSockets with Wasp (uses React, ExpressJS, and Socket.IO under the hood)",id:"implementing-websockets-with-wasp-uses-react-expressjs-and-socketio-under-the-hood",level:3},{value:"Conclusion",id:"conclusion",level:2}],u={toc:c},d="wrapper";function m(e){let{components:t,...n}=e;return(0,a.kt)(d,(0,o.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h2",{id:"tldr"},"TL;DR"),(0,a.kt)("p",null,"WebSockets allow your app to have \u201creal time\u201d features, where updates are instant because they\u2019re passed on an open, two-way channel. This is a different from CRUD apps, which usually use HTTP requests that must establish a connection, send a request, receive a response, and then close the connection."),(0,a.kt)(s.Z,{source:"img/websockets-app/Untitled.png",width:"550px",mdxType:"ImgWithCaption"}),(0,a.kt)("p",null,"To use WebSockets in your React app, you\u2019ll need a dedicated server, such as an ExpressJS app with NodeJS, in order to maintain a persistent connection."),(0,a.kt)("p",null,"Unfortunately, serverless solutions (e.g. NextJS, AWS lambda) don\u2019t natively support WebSockets. Bummer. \ud83d\ude1e "),(0,a.kt)("p",null,"Why not? Well, serverless services turn on and off depending on if a request is coming in. With WebSockets, we need this \u201calways on\u201d connection that only a dedicated server can provide (although you can pay for third-party services as a workaround)."),(0,a.kt)("p",null,"Luckily, we\u2019re going to talk about two great ways you can implement them:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Implementing and configuring it yourself with React, NodeJS, and Socket.IO"),(0,a.kt)("li",{parentName:"ol"},"By using ",(0,a.kt)("a",{parentName:"li",href:"https://wasp-lang.dev"},"Wasp"),", a full-stack React-NodeJS framework, to configure and integrate Socket.IO into your app for you.")),(0,a.kt)("p",null,"These methods allow you to build fun stuff, like this instantly updating \u201cvoting with friends\u201d app we built here (check out the ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/vincanger/websockets-wasp"},"GitHub repo for it"),"):"),(0,a.kt)("iframe",{width:"560",height:"315",src:"https://www.youtube.com/embed/Twy-2P0Co6M",title:"YouTube video player",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",allowfullscreen:!0}),(0,a.kt)("h2",{id:"why-websockets"},"Why WebSockets?"),(0,a.kt)("p",null,"So, imagine you're at a party sending text messages to a friend to tell them what food to bring. "),(0,a.kt)("p",null,"Now, wouldn\u2019t it be easier if you called your friend on the phone so you could talk constantly,  instead of sending sporadic messages? That's pretty much what WebSockets are in the world of web applications. "),(0,a.kt)("p",null,"For example, traditional HTTP requests (e.g. CRUD/RESTful) are like those text messages \u2014 your app has to ",(0,a.kt)("strong",{parentName:"p"},"ask the server")," every time it wants new information, just like you had to send a text message to your friend every time you thought of food for your party. "),(0,a.kt)("p",null,"But with WebSockets, once a connection is established, it ",(0,a.kt)("strong",{parentName:"p"},"remains open")," for constant, two-way communication, so the server can send new information to your app the instant it becomes available, even if the client didn\u2019t ask for it. "),(0,a.kt)("p",null,"This is perfect for real-time applications like chat apps, game servers, or when you're keeping track of stock prices. For example, apps like Google Docs, Slack, WhatsApp, Uber, Zoom, and Robinhood all use WebSockets to power their real-time communication features."),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://media3.giphy.com/media/26u4hHj87jMePiO3u/giphy.gif?cid=7941fdc6hxgjnub1rcs80udcj652956fwmm4qhxsmk6ldxg7&ep=v1_gifs_search&rid=giphy.gif&ct=g",alt:"https://media3.giphy.com/media/26u4hHj87jMePiO3u/giphy.gif?cid=7941fdc6hxgjnub1rcs80udcj652956fwmm4qhxsmk6ldxg7&ep=v1_gifs_search&rid=giphy.gif&ct=g"})),(0,a.kt)("p",null,"So remember, when your app and server have a lot to talk about, go for WebSockets and let the conversation flow freely!"),(0,a.kt)("h2",{id:"how-websockets-work"},"How WebSockets Work"),(0,a.kt)("p",null,"If you want real-time capabilities in your app, you don\u2019t always need WebSockets. You can implement similar functionality by using resource-heavy processes, such as:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"long-polling, e.g. running ",(0,a.kt)("inlineCode",{parentName:"li"},"setInterval")," to periodically hit the server and check for updates."),(0,a.kt)("li",{parentName:"ol"},"one-way \u201cserver-sent events\u201d, e.g. keeping a unidirectional server-to-client connection open to receive new updates from the server only.")),(0,a.kt)(s.Z,{source:"img/websockets-app/Untitled 1.png",width:"550px",caption:"1. HTTP handshake, 2. two-way instant communication, 3. close connection",mdxType:"ImgWithCaption"}),(0,a.kt)("p",null,"WebSockets, on the other hand, provide a two-way (aka \u201cfull-duplex\u201d) communication channel between the client and server. "),(0,a.kt)("p",null,"Once established via an HTTP \u201chandshake\u201d, the server and client can freely exchange information instantly before the connection is finally closed by either side."),(0,a.kt)("p",null,"Although introducing WebSockets does add complexity due to asynchronous and event-driven components, choosing the right libraries and frameworks can make it easy."),(0,a.kt)("p",null,"In the sections below, we will show you two ways to implement WebSockets into a React-NodeJS app:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Configuring it yourself alongside your own standalone Node/ExpressJS server"),(0,a.kt)("li",{parentName:"ol"},"Letting Wasp, a full-stack framework with superpowers, easily configure it for you")),(0,a.kt)("h2",{id:"adding-websockets-support-in-a-react-nodejs-app"},"Adding WebSockets Support in a React-NodeJS App"),(0,a.kt)("h3",{id:"what-you-shouldnt-use-serverless-architecture"},"What You Shouldn\u2019t Use: Serverless Architecture"),(0,a.kt)("p",null,"But first, here\u2019s a \u201cheads up\u201d for you: despite being a great solution for certain use-cases, serverless solutions are ",(0,a.kt)("strong",{parentName:"p"},"not")," the right tool for this job."),(0,a.kt)("p",null,"That means, popular frameworks and infrastructure, like NextJS and AWS Lambda, do not support WebSockets integration out-of-the-box. "),(0,a.kt)("iframe",{width:"560",height:"315",src:"https://www.youtube.com/embed/e5Cye4pIFeA",title:"YouTube video player",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",allowfullscreen:!0}),(0,a.kt)("p",null,"Instead of running on a dedicated, traditional server, such solutions utilize serverless functions (also known as lambda functions), which are designed to execute and complete a task as soon as a request comes in. It\u2019s as if they \u201cturn on\u201d when the request comes in, and then \u201cturn off\u201d once it\u2019s completed."),(0,a.kt)("p",null,"This serverless architecture is not ideal for keeping a WebSocket connection alive because we want a persistent, \u201calways-on\u201d connection."),(0,a.kt)("p",null,"That\u2019s why you need a \u201cserverful\u201d architecture if you want to build real-time apps. And although there is a workaround to getting WebSockets on a serverless architecture, ",(0,a.kt)("a",{parentName:"p",href:"https://vercel.com/guides/do-vercel-serverless-functions-support-websocket-connections"},"like using third-party services"),", this has a number of drawbacks:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Cost:")," these services exist as subscriptions and can get costly as your app scales"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Limited Customization:")," you\u2019re using a pre-built solution, so you have less control"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Debugging:")," fixing errors gets more difficult, as your app is not running locally")),(0,a.kt)(s.Z,{source:"img/websockets-app/Untitled 2.png",width:"550px",mdxType:"ImgWithCaption"}),(0,a.kt)("h3",{id:"using-expressjs-with-socketio---complexcustomizable-method"},"Using ExpressJS with Socket.IO  \u2014 Complex/Customizable Method"),(0,a.kt)("p",null,"Okay, let's start with the first, more traditional approach: creating a dedicated server for your client to establish a two-way communication channel with."),(0,a.kt)("admonition",{type:"note"},(0,a.kt)("p",{parentName:"admonition"},"\ud83d\udc68\u200d\ud83d\udcbb If you want to code along you can follow the instructions below. Alternatively, if you just want to see the finished React-NodeJS full-stack app, check out the ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/vincanger/websockets-react"},"github repo here"))),(0,a.kt)("p",null,"In this exampple, we\u2019ll be using ",(0,a.kt)("a",{parentName:"p",href:"https://expressjs.com/"},"ExpressJS")," with the ",(0,a.kt)("a",{parentName:"p",href:"http://Socket.io"},"Socket.IO")," library. Although there are others out there, Socket.IO is a great library that makes working with WebSockets in NodeJS ",(0,a.kt)("a",{parentName:"p",href:"https://socket.io/docs/v4/"},"easier"),"."),(0,a.kt)("p",null,"If you want to code along, first clone the ",(0,a.kt)("inlineCode",{parentName:"p"},"start")," branch:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"git clone --branch start https://github.com/vincanger/websockets-react.git\n")),(0,a.kt)("p",null,"You\u2019ll notice that inside we have two folders:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\ud83d\udcc1\xa0",(0,a.kt)("inlineCode",{parentName:"li"},"ws-client")," for our React app"),(0,a.kt)("li",{parentName:"ul"},"\ud83d\udcc1\xa0",(0,a.kt)("inlineCode",{parentName:"li"},"ws-server")," for our ExpressJS/NodeJS server")),(0,a.kt)("p",null,"Let\u2019s ",(0,a.kt)("inlineCode",{parentName:"p"},"cd")," into the server folder and install the dependencies:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"cd ws-server && npm install\n")),(0,a.kt)("p",null,"We also need to install the types for working with typescript:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"npm i --save-dev @types/cors\n")),(0,a.kt)("p",null,"Now run the server, using the ",(0,a.kt)("inlineCode",{parentName:"p"},"npm start")," command in your terminal. "),(0,a.kt)("p",null,"You should see ",(0,a.kt)("inlineCode",{parentName:"p"},"listening on *:8000")," printed to the console!"),(0,a.kt)("p",null,"At the moment, this is what our ",(0,a.kt)("inlineCode",{parentName:"p"},"index.ts")," file looks like:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-tsx"},"import cors from 'cors';\nimport express from 'express';\n\nconst app = express();\napp.use(cors({ origin: '*' }));\nconst server = require('http').createServer(app);\n\napp.get('/', (req, res) => {\n  res.send(`<h1>Hello World</h1>`);\n});\n\nserver.listen(8000, () => {\n  console.log('listening on *:8000');\n});\n")),(0,a.kt)("p",null,"There\u2019s not much going on here, so let\u2019s install the ",(0,a.kt)("a",{parentName:"p",href:"http://Socket.IO"},"Socket.IO")," package and start adding WebSockets to our server!"),(0,a.kt)("p",null,"First, let\u2019s kill the server with ",(0,a.kt)("inlineCode",{parentName:"p"},"ctrl + c")," and then run: "),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"npm install socket.io\n")),(0,a.kt)("p",null,"Let\u2019s go ahead and replace the ",(0,a.kt)("inlineCode",{parentName:"p"},"index.ts")," file with the following code. I know it\u2019s a lot of code, so I\u2019ve left a bunch of comments that explain what\u2019s going on ;):"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-tsx"},"import cors from 'cors';\nimport express from 'express';\nimport { Server, Socket } from 'socket.io';\n\ntype PollState = {\n  question: string;\n  options: {\n    id: number;\n    text: string;\n    description: string;\n    votes: string[];\n  }[];\n};\ninterface ClientToServerEvents {\n  vote: (optionId: number) => void;\n  askForStateUpdate: () => void;\n}\ninterface ServerToClientEvents {\n  updateState: (state: PollState) => void;\n}\ninterface InterServerEvents { }\ninterface SocketData {\n  user: string;\n}\n\nconst app = express();\napp.use(cors({ origin: 'http://localhost:5173' })); // this is the default port that Vite runs your React app on\nconst server = require('http').createServer(app);\n// passing these generic type parameters to the `Server` class\n// ensures data flowing through the server are correctly typed.\nconst io = new Server<\n  ClientToServerEvents,\n  ServerToClientEvents,\n  InterServerEvents,\n  SocketData\n>(server, {\n  cors: {\n    origin: 'http://localhost:5173',\n    methods: ['GET', 'POST'],\n  },\n});\n\n// this is middleware that Socket.IO uses on initiliazation to add\n// the authenticated user to the socket instance. Note: we are not\n// actually adding real auth as this is beyond the scope of the tutorial\nio.use(addUserToSocketDataIfAuthenticated);\n\n// the client will pass an auth \"token\" (in this simple case, just the username)\n// to the server on initialize of the Socket.IO client in our React App\nasync function addUserToSocketDataIfAuthenticated(socket: Socket, next: (err?: Error) => void) {\n  const user = socket.handshake.auth.token;\n  if (user) {\n    try {\n      socket.data = { ...socket.data, user: user };\n    } catch (err) {}\n  }\n  next();\n}\n\n// the server determines the PollState object, i.e. what users will vote on\n// this will be sent to the client and displayed on the front-end\nconst poll: PollState = {\n  question: \"What are eating for lunch \u2728 Let's order\",\n  options: [\n    {\n      id: 1,\n      text: 'Party Pizza Place',\n      description: 'Best pizza in town',\n      votes: [],\n    },\n    {\n      id: 2,\n      text: 'Best Burger Joint',\n      description: 'Best burger in town',\n      votes: [],\n    },\n    {\n      id: 3,\n      text: 'Sus Sushi Place',\n      description: 'Best sushi in town',\n      votes: [],\n    },\n  ],\n};\n\nio.on('connection', (socket) => {\n  console.log('a user connected', socket.data.user);\n\n    // the client will send an 'askForStateUpdate' request on mount\n    // to get the initial state of the poll\n  socket.on('askForStateUpdate', () => {\n    console.log('client asked For State Update');\n    socket.emit('updateState', poll);\n  });\n\n  socket.on('vote', (optionId: number) => {\n    // If user has already voted, remove their vote.\n    poll.options.forEach((option) => {\n      option.votes = option.votes.filter((user) => user !== socket.data.user);\n    });\n    // And then add their vote to the new option.\n    const option = poll.options.find((o) => o.id === optionId);\n    if (!option) {\n      return;\n    }\n    option.votes.push(socket.data.user);\n        // Send the updated PollState back to all clients\n    io.emit('updateState', poll);\n  });\n\n  socket.on('disconnect', () => {\n    console.log('user disconnected');\n  });\n});\n\nserver.listen(8000, () => {\n  console.log('listening on *:8000');\n});\n")),(0,a.kt)("p",null,"Great, start the server again with ",(0,a.kt)("inlineCode",{parentName:"p"},"npm start")," and let\u2019s add the ",(0,a.kt)("a",{parentName:"p",href:"http://Socket.IO"},"Socket.IO")," client to the front-end."),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"cd")," into the ",(0,a.kt)("inlineCode",{parentName:"p"},"ws-client")," directory and run"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"cd ../ws-client && npm install\n")),(0,a.kt)("p",null,"Next, start the development server with ",(0,a.kt)("inlineCode",{parentName:"p"},"npm run dev")," and you should see the hardcoded starter app in your browser:"),(0,a.kt)(s.Z,{source:"img/websockets-app/Untitled 3.png",width:"550px",mdxType:"ImgWithCaption"}),(0,a.kt)("p",null,"You may have noticed that poll does not match the ",(0,a.kt)("inlineCode",{parentName:"p"},"PollState")," from our server. We need to install the ",(0,a.kt)("a",{parentName:"p",href:"http://Socket.IO"},"Socket.IO")," client and set it all up in order start our real-time communication and get the correct poll from the server."),(0,a.kt)("p",null,"Go ahead and kill the development server with ",(0,a.kt)("inlineCode",{parentName:"p"},"ctrl + c")," and run:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"npm install socket.io-client\n")),(0,a.kt)("p",null,"Now let\u2019s create a hook that initializes and returns our WebSocket client after it establishes a connection. To do that, create a new file in ",(0,a.kt)("inlineCode",{parentName:"p"},"./ws-client/src")," called ",(0,a.kt)("inlineCode",{parentName:"p"},"useSocket.ts"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-tsx"},"import { useState, useEffect } from 'react';\nimport socketIOClient, { Socket } from 'socket.io-client';\n\nexport type PollState = {\n  question: string;\n  options: {\n    id: number;\n    text: string;\n    description: string;\n    votes: string[];\n  }[];\n};\ninterface ServerToClientEvents {\n  updateState: (state: PollState) => void;\n}\ninterface ClientToServerEvents {\n  vote: (optionId: number) => void;\n  askForStateUpdate: () => void;\n}\n\nexport function useSocket({endpoint, token } : { endpoint: string, token: string }) {\n  // initialize the client using the server endpoint, e.g. localhost:8000\n    // and set the auth \"token\" (in our case we're simply passing the username\n    // for simplicity -- you would not do this in production!)\n    // also make sure to use the Socket generic types in the reverse order of the server!\n    const socket: Socket<ServerToClientEvents, ClientToServerEvents>  = socketIOClient(endpoint,  {\n    auth: {\n      token: token\n    }\n  }) \n  const [isConnected, setIsConnected] = useState(false);\n\n  useEffect(() => {\n    console.log('useSocket useEffect', endpoint, socket)\n\n    function onConnect() {\n      setIsConnected(true)\n    }\n\n    function onDisconnect() {\n      setIsConnected(false)\n    }\n\n    socket.on('connect', onConnect)\n    socket.on('disconnect', onDisconnect)\n\n    return () => {\n      socket.off('connect', onConnect)\n      socket.off('disconnect', onDisconnect)\n    }\n  }, [token]);\n\n    // we return the socket client instance and the connection state\n  return {\n    isConnected,\n    socket,\n  };\n}\n")),(0,a.kt)("p",null,"Now let\u2019s go back to our main ",(0,a.kt)("inlineCode",{parentName:"p"},"App.tsx")," page and replace it with the following code (again I\u2019ve left comments to explain):"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-tsx"},"import { useState, useMemo, useEffect } from 'react';\nimport { Layout } from './Layout';\nimport { Button, Card } from 'flowbite-react';\nimport { useSocket } from './useSocket';\nimport type { PollState } from './useSocket';\n\nconst App = () => {\n    // set the PollState after receiving it from the server\n  const [poll, setPoll] = useState<PollState | null>(null);\n     \n    // since we're not implementing Auth, let's fake it by\n    // creating some random user names when the App mounts\n  const randomUser = useMemo(() => {\n    const randomName = Math.random().toString(36).substring(7);\n    return `User-${randomName}`;\n  }, []);\n    \n    // \ud83d\udd0c\u26a1\ufe0f get the connected socket client from our useSocket hook! \n  const { socket, isConnected } = useSocket({ endpoint: `http://localhost:8000`, token: randomUser });\n\n  const totalVotes = useMemo(() => {\n    return poll?.options.reduce((acc, option) => acc + option.votes.length, 0) ?? 0;\n  }, [poll]);\n\n    // every time we receive an 'updateState' event from the server\n    // e.g. when a user makes a new vote, we set the React's state\n    // with the results of the new PollState \n  socket.on('updateState', (newState: PollState) => {\n    setPoll(newState);\n  });\n\n  useEffect(() => {\n    socket.emit('askForStateUpdate');\n  }, []);\n\n  function handleVote(optionId: number) {\n    socket.emit('vote', optionId);\n  }\n\n  return (\n    <Layout user={randomUser}>\n      <div className='w-full max-w-2xl mx-auto p-8'>\n        <h1 className='text-2xl font-bold'>{poll?.question ?? 'Loading...'}</h1>\n        <h2 className='text-lg italic'>{isConnected ? 'Connected \u2705' : 'Disconnected \ud83d\uded1'}</h2>\n        {poll && <p className='leading-relaxed text-gray-500'>Cast your vote for one of the options.</p>}\n        {poll && (\n          <div className='mt-4 flex flex-col gap-4'>\n            {poll.options.map((option) => (\n              <Card key={option.id} className='relative transition-all duration-300 min-h-[130px]'>\n                <div className='z-10'>\n                  <div className='mb-2'>\n                    <h2 className='text-xl font-semibold'>{option.text}</h2>\n                    <p className='text-gray-700'>{option.description}</p>\n                  </div>\n                  <div className='absolute bottom-5 right-5'>\n                    {randomUser && !option.votes.includes(randomUser) ? (\n                      <Button onClick={() => handleVote(option.id)}>Vote</Button>\n                    ) : (\n                      <Button disabled>Voted</Button>\n                    )}\n                  </div>\n                  {option.votes.length > 0 && (\n                    <div className='mt-2 flex gap-2 flex-wrap max-w-[75%]'>\n                      {option.votes.map((vote) => (\n                        <div\n                          key={vote}\n                          className='py-1 px-3 bg-gray-100 rounded-lg flex items-center justify-center shadow text-sm'\n                        >\n                          <div className='w-2 h-2 bg-green-500 rounded-full mr-2'></div>\n                          <div className='text-gray-700'>{vote}</div>\n                        </div>\n                      ))}\n                    </div>\n                  )}\n                </div>\n                <div className='absolute top-5 right-5 p-2 text-sm font-semibold bg-gray-100 rounded-lg z-10'>\n                  {option.votes.length} / {totalVotes}\n                </div>\n                <div\n                  className='absolute inset-0 bg-gradient-to-r from-yellow-400 to-orange-500 opacity-75 rounded-lg transition-all duration-300'\n                  style={{\n                    width: `${totalVotes > 0 ? (option.votes.length / totalVotes) * 100 : 0}%`,\n                  }}\n                ></div>\n              </Card>\n            ))}\n          </div>\n        )}\n      </div>\n    </Layout>\n  );\n};\nexport default App;\n")),(0,a.kt)("p",null,"Go ahead now and start the client with ",(0,a.kt)("inlineCode",{parentName:"p"},"npm run dev"),". Open another terminal window/tab, ",(0,a.kt)("inlineCode",{parentName:"p"},"cd")," into the ",(0,a.kt)("inlineCode",{parentName:"p"},"ws-server")," directory and run ",(0,a.kt)("inlineCode",{parentName:"p"},"npm start"),"."),(0,a.kt)("p",null,"If we did that correctly, we should be seeing our finished, working, REAL TIME app! \ud83d\ude42"),(0,a.kt)("p",null,"It looks and works great if you open it up in two or three browser tabs. Check it out:"),(0,a.kt)(s.Z,{source:"img/websockets-app/Untitled.gif",width:"550px",mdxType:"ImgWithCaption"}),(0,a.kt)("p",null,"Nice!"),(0,a.kt)("p",null,"So we\u2019ve got the core functionality here, but as this is just a demo, there are a couple very important pieces missing that make this app unusable in production."),(0,a.kt)("p",null,"Mainly, we\u2019re creating a random fake user each time the app mounts. You can check this by refreshing the page and voting again. You\u2019ll see the votes just add up, as we\u2019re creating a new random user each time. We don\u2019t want that! "),(0,a.kt)("p",null,"We should instead be authenticating and persisting a session for a user that\u2019s registered in our database. But another problem: we don\u2019t even have a database at all in this app!"),(0,a.kt)("p",null,"You can start to see the how the complexity add ups for even just a simple voting feature"),(0,a.kt)("p",null,"Luckily, our next solution, Wasp, has integrated Authentication and Database Management. Not to mention, it also takes care of a lot of the WebSockets configuration for us."),(0,a.kt)("p",null,"So let\u2019s go ahead and give that a go! "),(0,a.kt)("h3",{id:"implementing-websockets-with-wasp--fastzero-config-method"},"Implementing WebSockets with Wasp \u2014 Fast/Zero Config Method"),(0,a.kt)("p",null,"Because Wasp is an innovative full-stack framework, it makes building React-NodeJS apps quick and developer-friendly. "),(0,a.kt)("p",null,"Wasp has lots of time-saving features, including WebSocket support via ",(0,a.kt)("a",{parentName:"p",href:"http://socket.io/"},"Socket.IO"),", Authentication, Database Management, and Full-stack type-safety out-of-the box."),(0,a.kt)("p",null,"Wasp can take care of all this heavy lifting for you because of its use of a config file, which you can think of like a set of instructions that the Wasp compiler uses to help glue your app together."),(0,a.kt)("p",null,"To see it in action, let's implement WebSocket communication using Wasp by following these steps "),(0,a.kt)("admonition",{type:"tip"},(0,a.kt)("p",{parentName:"admonition"},"If you just want to see finished app\u2019s code, you can check out the ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/vincanger/websockets-wasp"},"GitHub repo here"))),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Install Wasp globally by running the following command in your terminal:")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"curl -sSL [https://get.wasp-lang.dev/installer.sh](https://get.wasp-lang.dev/installer.sh) | sh \n")),(0,a.kt)("p",null,"If you want to code along, first clone the ",(0,a.kt)("inlineCode",{parentName:"p"},"start")," branch of the example app:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"git clone --branch start https://github.com/vincanger/websockets-wasp.git\n")),(0,a.kt)("p",null,"You\u2019ll notice that the structure of the Wasp app is split:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\ud83d\udc1d\xa0a ",(0,a.kt)("inlineCode",{parentName:"li"},"main.wasp")," config file exists at the root"),(0,a.kt)("li",{parentName:"ul"},"\ud83d\udcc1\xa0",(0,a.kt)("inlineCode",{parentName:"li"},"src/client")," is our directory for our React files"),(0,a.kt)("li",{parentName:"ul"},"\ud83d\udcc1\xa0",(0,a.kt)("inlineCode",{parentName:"li"},"src/server")," is our directory for our ExpressJS/NodeJS functions")),(0,a.kt)("p",null,"Let\u2019s start out by taking a quick look at our ",(0,a.kt)("inlineCode",{parentName:"p"},"main.wasp")," file."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-jsx"},'app whereDoWeEat {\n  wasp: {\n    version: "^0.11.0"\n  },\n  title: "where-do-we-eat",\n  client: {\n    rootComponent: import { Layout } from "@client/Layout.jsx",\n  },\n    // \ud83d\udd10 this is how we get auth in our app.\n  auth: {\n    userEntity: User,\n    onAuthFailedRedirectTo: "/login",\n    methods: {\n      usernameAndPassword: {}\n    }\n  },\n  dependencies: [\n    ("flowbite", "1.6.6"),\n    ("flowbite-react", "0.4.9")\n  ]\n}\n\n// \ud83d\udc71 this is the data model for our registered users in our database\nentity User {=psl\n  id       Int     @id @default(autoincrement())\n  username String  @unique\n  password String\npsl=}\n\n// ...\n')),(0,a.kt)("p",null,"With this, the Wasp compiler will know what to do and will configure these features for us."),(0,a.kt)("p",null,"Let\u2019s tell it we want WebSockets, as well. Add the ",(0,a.kt)("inlineCode",{parentName:"p"},"webSocket")," definition to the ",(0,a.kt)("inlineCode",{parentName:"p"},"main.wasp")," file, just between ",(0,a.kt)("inlineCode",{parentName:"p"},"auth")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"dependencies"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-jsx"},'app whereDoWeEat {\n    // ... \n  webSocket: {\n    fn: import { webSocketFn } from "@server/ws-server.js",\n  },\n    // ...\n}\n')),(0,a.kt)("p",null,"Now we have to define the ",(0,a.kt)("inlineCode",{parentName:"p"},"webSocketFn"),". In the ",(0,a.kt)("inlineCode",{parentName:"p"},"./src/server")," directory create a new file, ",(0,a.kt)("inlineCode",{parentName:"p"},"ws-server.ts")," and copy the following code:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-tsx"},"import { WebSocketDefinition } from '@wasp/webSocket';\nimport { User } from '@wasp/entities';\n\n// define the types. this time we will get the entire User object\n// in SocketData from the Auth that Wasp automatically sets up for us \ud83c\udf89\ntype PollState = {\n  question: string;\n  options: {\n    id: number;\n    text: string;\n    description: string;\n    votes: string[];\n  }[];\n};\ninterface ServerToClientEvents {\n  updateState: (state: PollState) => void;\n}\ninterface ClientToServerEvents {\n  vote: (optionId: number) => void;\n  askForStateUpdate: () => void;\n}\ninterface InterServerEvents {}\ninterface SocketData {\n  user: User; \n}\n\n// pass the generic types to the websocketDefinition just like \n// in the previous example\nexport const webSocketFn: WebSocketDefinition<\n  ClientToServerEvents,\n  ServerToClientEvents,\n  InterServerEvents,\n  SocketData\n> = (io, _context) => {\n  const poll: PollState = {\n    question: \"What are eating for lunch \u2728 Let's order\",\n    options: [\n      {\n        id: 1,\n        text: 'Party Pizza Place',\n        description: 'Best pizza in town',\n        votes: [],\n      },\n      {\n        id: 2,\n        text: 'Best Burger Joint',\n        description: 'Best burger in town',\n        votes: [],\n      },\n      {\n        id: 3,\n        text: 'Sus Sushi Place',\n        description: 'Best sushi in town',\n        votes: [],\n      },\n    ],\n  };\n  io.on('connection', (socket) => {\n    if (!socket.data.user) {\n      console.log('Socket connected without user');\n      return;\n    }\n\n    console.log('Socket connected: ', socket.data.user?.username);\n    socket.on('askForStateUpdate', () => {\n      socket.emit('updateState', poll);\n    });\n\n    socket.on('vote', (optionId) => {\n      // If user has already voted, remove their vote.\n      poll.options.forEach((option) => {\n        option.votes = option.votes.filter((username) => username !== socket.data.user.username);\n      });\n      // And then add their vote to the new option.\n      const option = poll.options.find((o) => o.id === optionId);\n      if (!option) {\n        return;\n      }\n      option.votes.push(socket.data.user.username);\n      io.emit('updateState', poll);\n    });\n\n    socket.on('disconnect', () => {\n      console.log('Socket disconnected: ', socket.data.user?.username);\n    });\n  });\n};\n")),(0,a.kt)("p",null,"You may have noticed that there\u2019s a lot less configuration and boilerplate needed here in the Wasp implementation. That\u2019s because the: "),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"endpoints,"),(0,a.kt)("li",{parentName:"ul"},"authentication,"),(0,a.kt)("li",{parentName:"ul"},"and Express and ",(0,a.kt)("a",{parentName:"li",href:"http://Socket.IO"},"Socket.IO")," middleware")),(0,a.kt)("p",null,"are all being handled for you by Wasp. Noice!"),(0,a.kt)(s.Z,{source:"img/websockets-app/Untitled 4.png",width:"550px",mdxType:"ImgWithCaption"}),(0,a.kt)("p",null,"Let\u2019s go ahead now and run the app to see what we have at this point. "),(0,a.kt)("p",null,"First, we need to initialize the database so that our Auth works correctly. This is something we didn\u2019t do in the previous example due to high complexity, but is easy to do with Wasp:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"wasp db migrate-dev\n")),(0,a.kt)("p",null,"Once that\u2019s finished, run the app (it my take a while on first run to install all depenedencies):"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"wasp start\n")),(0,a.kt)("p",null,"You should see a login screen this time. Go ahead and first register a user, then login:"),(0,a.kt)(s.Z,{source:"img/websockets-app/Untitled 5.png",width:"550px",mdxType:"ImgWithCaption"}),(0,a.kt)("p",null,"Once logged in, you\u2019ll see the same hardcoded poll data as in the previous example, because, again, we haven\u2019t set up the ",(0,a.kt)("a",{parentName:"p",href:"http://Socket.IO"},"Socket.IO")," client on the frontend. But this time it should be much easier."),(0,a.kt)("p",null,"Why? Well, besides less configuration, another nice benefit of working with ",(0,a.kt)("a",{parentName:"p",href:"/docs/advanced/web-sockets"},"TypeScript with Wasp"),", is that you just have to define payload types with matching event names on the server, and those types will get exposed automatically on the client! "),(0,a.kt)("p",null,"Let\u2019s take a look at how that works now."),(0,a.kt)("p",null,"In ",(0,a.kt)("inlineCode",{parentName:"p"},".src/client/MainPage.tsx"),", replace the contents with the following code:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-tsx"},'import { useState, useMemo, useEffect } from "react";\nimport { Button, Card } from "flowbite-react";\n// Wasp provides us with pre-configured hooks and types based on\n// our server code. No need to set it up ourselves!\nimport {\n  useSocketListener,\n  useSocket,\n  ServerToClientPayload,\n} from "@wasp/webSocket";\nimport useAuth from "@wasp/auth/useAuth";\n\nconst MainPage = () => {\n    // we can easily access the logged in user with this hook\n    // that wasp provides for us\n  const { data: user } = useAuth();\n  const [poll, setPoll] = useState<ServerToClientPayload<"updateState"> | null>(\n    null\n  );\n  const totalVotes = useMemo(() => {\n    return (\n      poll?.options.reduce((acc, option) => acc + option.votes.length, 0) ?? 0\n    );\n  }, [poll]);\n    \n    // pre-built hooks, configured for us by Wasp\n  const { socket } = useSocket(); \n  useSocketListener("updateState", (newState) => {\n    setPoll(newState);\n  });\n\n  useEffect(() => {\n    socket.emit("askForStateUpdate");\n  }, []);\n\n  function handleVote(optionId: number) {\n    socket.emit("vote", optionId);\n  }\n\n  return (\n    <div className="w-full max-w-2xl mx-auto p-8">\n      <h1 className="text-2xl font-bold">{poll?.question ?? "Loading..."}</h1>\n      {poll && (\n        <p className="leading-relaxed text-gray-500">\n          Cast your vote for one of the options.\n        </p>\n      )}\n      {poll && (\n        <div className="mt-4 flex flex-col gap-4">\n          {poll.options.map((option) => (\n            <Card key={option.id} className="relative transition-all duration-300 min-h-[130px]">\n              <div className="z-10">\n                <div className="mb-2">\n                  <h2 className="text-xl font-semibold">{option.text}</h2>\n                  <p className="text-gray-700">{option.description}</p>\n                </div>\n                <div className="absolute bottom-5 right-5">\n                  {user && !option.votes.includes(user.username) ? (\n                    <Button onClick={() => handleVote(option.id)}>Vote</Button>\n                  ) : (\n                    <Button disabled>Voted</Button>\n                  )}\n                  {!user}\n                </div>\n                {option.votes.length > 0 && (\n                  <div className="mt-2 flex gap-2 flex-wrap max-w-[75%]">\n                    {option.votes.map((vote) => (\n                      <div\n                        key={vote}\n                        className="py-1 px-3 bg-gray-100 rounded-lg flex items-center justify-center shadow text-sm"\n                      >\n                        <div className="w-2 h-2 bg-green-500 rounded-full mr-2"></div>\n                        <div className="text-gray-700">{vote}</div>\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </div>\n              <div className="absolute top-5 right-5 p-2 text-sm font-semibold bg-gray-100 rounded-lg z-10">\n                {option.votes.length} / {totalVotes}\n              </div>\n              <div\n                className="absolute inset-0 bg-gradient-to-r from-yellow-400 to-orange-500 opacity-75 rounded-lg transition-all duration-300"\n                style={{\n                  width: `${\n                    totalVotes > 0\n                      ? (option.votes.length / totalVotes) * 100\n                      : 0\n                  }%`,\n                }}\n              ></div>\n            </Card>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n};\nexport default MainPage;\n')),(0,a.kt)("p",null,"In comparison to the previous implementation, Wasp saved us from having to configure the ",(0,a.kt)("a",{parentName:"p",href:"http://Socket.IO"},"Socket.IO")," client, as well as building our own hooks."),(0,a.kt)("p",null,"Also, hover over the variables in your client-side code, and you\u2019ll see that the types are being automatically inferred for you! "),(0,a.kt)("p",null,"Here\u2019s just one example, but it should work for them all:"),(0,a.kt)(s.Z,{source:"img/websockets-app/Untitled 6.png",width:"550px",mdxType:"ImgWithCaption"}),(0,a.kt)("p",null,"Now if you open up a new private/incognito tab, register a new user, and login, you\u2019ll see a fully working, real-time voting app. The best part is, in comparison to the previous approach, we can log out and back in, and our voting data persists, which is exactly what we\u2019d expect from a production grade app. \ud83c\udfa9"),(0,a.kt)(s.Z,{source:"img/websockets-app/Untitled 1.gif",width:"550px",mdxType:"ImgWithCaption"}),(0,a.kt)("p",null,"Awesome\u2026 \ud83d\ude0f"),(0,a.kt)("h2",{id:"comparing-the-two-approaches"},"Comparing the Two Approaches"),(0,a.kt)("p",null,"Now, just because one approach seems easier, doesn\u2019t always mean it\u2019s always better. Let\u2019s give a quick run-down of the advantages and disadvantages of both the implementations above."),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null}),(0,a.kt)("th",{parentName:"tr",align:null},"Without Wasp"),(0,a.kt)("th",{parentName:"tr",align:null},"With Wasp"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"\ud83d\ude0e\xa0Intended User"),(0,a.kt)("td",{parentName:"tr",align:null},"Senior Developers, web development teams"),(0,a.kt)("td",{parentName:"tr",align:null},"Full-stack developers, \u201cIndiehackers\u201d, junior devs")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"\ud83d\udcc8\xa0Complexity of Code"),(0,a.kt)("td",{parentName:"tr",align:null},"Medium-to-High"),(0,a.kt)("td",{parentName:"tr",align:null},"Low")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"\ud83d\udea4\xa0Speed"),(0,a.kt)("td",{parentName:"tr",align:null},"Slower, more methodical"),(0,a.kt)("td",{parentName:"tr",align:null},"Faster, more integrated")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"\ud83e\uddd1\u200d\ud83d\udcbb\xa0Libraries"),(0,a.kt)("td",{parentName:"tr",align:null},"Any"),(0,a.kt)("td",{parentName:"tr",align:null},"Socket.IO")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"\u26d1\xa0Type safety"),(0,a.kt)("td",{parentName:"tr",align:null},"Implement on both server and client"),(0,a.kt)("td",{parentName:"tr",align:null},"Implement once on server, inferred by Wasp on client")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"\ud83c\udfae\xa0Amount of control"),(0,a.kt)("td",{parentName:"tr",align:null},"High, as you determine the implementation"),(0,a.kt)("td",{parentName:"tr",align:null},"Opinionated, as Wasp decides the basic implementation")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"\ud83d\udc1b\xa0Learning Curve"),(0,a.kt)("td",{parentName:"tr",align:null},"Complex: full knowledge of front and backend technologies, including WebSockets"),(0,a.kt)("td",{parentName:"tr",align:null},"Intermediate: Knowledge of full-stack fundamentals necessary.")))),(0,a.kt)("h3",{id:"implementing-websockets-using-react-expressjs-without-wasp"},"Implementing WebSockets Using React, Express.js (Without Wasp)"),(0,a.kt)("p",null,"Advantages:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Control & ",(0,a.kt)("strong",{parentName:"li"},"Flexibility"),": You can approach the implementation of WebSockets in the way that best suits your project's needs, as well as your choice between a ",(0,a.kt)("a",{parentName:"li",href:"https://www.atatus.com/blog/websocket-libraries-for-nodejs/"},"number of different WebSocket libraries"),", not just Socket.IO.")),(0,a.kt)("p",null,"Disadvantages:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("strong",{parentName:"li"},"More Code & Complexity"),": Without the abstractions provided by a framework like Wasp, you might need to write more code and create your own abstractions to handle common tasks. Not to mention the proper configuration of a NodeJS/ExpressJS server (the one provided in the example is very basic)"),(0,a.kt)("li",{parentName:"ol"},"Manual ",(0,a.kt)("strong",{parentName:"li"},"Type Safety: If you\u2019re working with TypeScript, you have to be more careful typing your  event handlers and payload types coming into and going out from the server, or implement a more type-safe approach yourself."))),(0,a.kt)("h3",{id:"implementing-websockets-with-wasp-uses-react-expressjs-and-socketio-under-the-hood"},"Implementing WebSockets with Wasp (uses React, ExpressJS, and ",(0,a.kt)("a",{parentName:"h3",href:"http://Socket.IO"},"Socket.IO")," under the hood)"),(0,a.kt)("p",null,"Advantages:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Fully-Integrated",(0,a.kt)("strong",{parentName:"li"},"/Less code"),": Wasp provides useful abstractions such as ",(0,a.kt)("inlineCode",{parentName:"li"},"useSocket")," and ",(0,a.kt)("inlineCode",{parentName:"li"},"useSocketListener")," hooks for use in React components (on top of other features like Auth, Async Jobs, Email-sending, DB management, and Deployment), simplifying the client-side code, and allowing for full integration with less configuration."),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("strong",{parentName:"li"},"Type Safety"),": Wasp facilitates full-stack type safety for WebSocket events and payloads. This reduces the likelihood of runtime errors due to mismatched data types and saves you from writing even more boilerplate.")),(0,a.kt)("p",null,"Disadvantages:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("strong",{parentName:"li"},"Learning curve"),": Developers unfamiliar with Wasp will need to learn the framework to effectively use it."),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("strong",{parentName:"li"},"Less control"),": While Wasp provides a lot of conveniences, it abstracts away some of the details, giving developers slightly less control over certain aspects of socket management.")),(0,a.kt)("h2",{id:"conclusion"},"Conclusion"),(0,a.kt)("p",null,"In general, how you add WebSockets to your React app depends on the specifics of your project, your comfort level with the available tools, and the trade-offs you're willing to make between ease of use, control, and complexity."),(0,a.kt)("p",null,"Don\u2019t forget, if you want to check out the full finished code from our \u201cLunch Voting\u201d example full-stack app, go here: ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/vincanger/websockets-wasp"},"https://github.com/vincanger/websockets-wasp")),(0,a.kt)("p",null,"And if you know of a better, cooler, sleeker way of implementing WebSockets into your apps, let us know in the comments below"),(0,a.kt)(s.Z,{source:"img/websockets-app/Untitled 7.png",width:"550px",mdxType:"ImgWithCaption"}))}m.isMDXComponent=!0},70589:(e,t,n)=>{n.d(t,{ZP:()=>r});var o=n(87462),a=(n(67294),n(3905));const s={toc:[]},i="wrapper";function r(e){let{components:t,...n}=e;return(0,a.kt)(i,(0,o.Z)({},s,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,(0,a.kt)("em",{parentName:"p"},"Wasp is a configuration language (DSL) for building full-stack web apps with less code and best practices that works alongside React and Node.js. We are on a mission to streamline web app development while empowering developers to continue using the power of code and their favorite tools. We are backed by Y Combinator and engineers from Airbnb, Facebook, and Lyft.")))}r.isMDXComponent=!0}}]);